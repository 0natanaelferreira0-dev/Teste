<!DOCTYPE html>

<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Calculadora de Hidratos de Carbono baseada na Tabela APDP">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Contador HC">
    <title>Contador de Hidratos de Carbono</title>
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%234F46E5' width='100' height='100' rx='20'/><text x='50' y='70' font-size='60' text-anchor='middle' fill='white' font-family='Arial'>HC</text></svg>">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }
        .dropdown {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        .dropdown.active {
            max-height: 300px;
            overflow-y: auto;
        }
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .item-enter {
            animation: slideIn 0.3s ease-out;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen p-4">
    <div class="max-w-2xl mx-auto">
        <!-- Header -->
        <div class="bg-white rounded-2xl shadow-xl p-6 mb-6">
            <div class="flex items-center gap-3 mb-2">
                <svg class="w-8 h-8 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                </svg>
                <h1 class="text-3xl font-bold text-gray-800">Contador de HC</h1>
            </div>
            <p class="text-gray-600 text-sm">Tabela APDP - Contagem de Hidratos de Carbono</p>
        </div>

```
    <!-- Formul√°rio -->
    <div class="bg-white rounded-2xl shadow-xl p-6 mb-6">
        <h2 class="text-xl font-semibold text-gray-800 mb-4">Adicionar Alimento</h2>
        
        <!-- Categoria -->
        <div class="mb-4">
            <label class="block text-sm font-medium text-gray-700 mb-2">Categoria</label>
            <button onclick="toggleDropdown('category')" class="w-full px-4 py-3 text-left bg-gray-50 border border-gray-300 rounded-xl hover:bg-gray-100 transition flex items-center justify-between">
                <span id="selectedCategory" class="text-gray-500">Selecione uma categoria</span>
                <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
            </button>
            <div id="categoryDropdown" class="dropdown bg-white border border-gray-300 rounded-xl shadow-lg mt-2">
                <div id="categoryList"></div>
            </div>
        </div>

        <!-- Alimento -->
        <div id="foodSection" class="mb-4 hidden">
            <label class="block text-sm font-medium text-gray-700 mb-2">Alimento</label>
            <button onclick="toggleDropdown('food')" class="w-full px-4 py-3 text-left bg-gray-50 border border-gray-300 rounded-xl hover:bg-gray-100 transition flex items-center justify-between">
                <span id="selectedFood" class="text-gray-500">Selecione um alimento</span>
                <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
            </button>
            <div id="foodDropdown" class="dropdown bg-white border border-gray-300 rounded-xl shadow-lg mt-2">
                <div id="foodList"></div>
            </div>
        </div>

        <!-- Peso -->
        <div id="weightSection" class="mb-4 hidden">
            <label class="block text-sm font-medium text-gray-700 mb-2">Peso (gramas)</label>
            <input 
                type="number" 
                id="weightInput" 
                placeholder="Ex: 150"
                class="w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                oninput="updatePreview()"
                onkeypress="if(event.key === 'Enter') addFood()"
            >
            <p id="carbPreview" class="text-sm text-indigo-600 mt-2 hidden"></p>
        </div>

        <!-- Bot√£o adicionar -->
        <button 
            id="addButton" 
            onclick="addFood()" 
            class="w-full bg-indigo-600 text-white py-3 rounded-xl hover:bg-indigo-700 transition font-medium hidden">
            <span class="flex items-center justify-center gap-2">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                </svg>
                Adicionar √† Refei√ß√£o
            </span>
        </button>
    </div>

    <!-- Lista de itens -->
    <div id="mealSection" class="bg-white rounded-2xl shadow-xl p-6 mb-6 hidden">
        <div class="flex items-center justify-between mb-4">
            <h2 class="text-xl font-semibold text-gray-800">Refei√ß√£o Atual</h2>
            <button onclick="resetMeal()" class="text-sm text-red-600 hover:text-red-700 font-medium">
                Limpar Tudo
            </button>
        </div>
        <div id="mealItems" class="space-y-3"></div>
    </div>

    <!-- Total -->
    <div id="totalSection" class="bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl shadow-xl p-8 text-white hidden">
        <div class="text-center">
            <p class="text-lg font-medium mb-2 opacity-90">Total de Hidratos de Carbono</p>
            <p id="totalCarbs" class="text-6xl font-bold mb-4">0.0g</p>
            <div class="bg-white/20 rounded-xl p-4 backdrop-blur-sm">
                <p class="text-sm font-medium">üíâ Insira este valor na bomba de insulina</p>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="mt-6 text-center text-sm text-gray-600">
        <p>Fonte: APDP 2020 ‚Ä¢ Tabela de Composi√ß√£o dos Alimentos Portuguesa</p>
        <p class="mt-1">Para alimentos embalados, consulte sempre o r√≥tulo nutricional</p>
    </div>
</div>

<script>
    // Base de dados completa
    const foodDatabase = {
        "Cereais e Pseudo-cereais": {
            "Arroz integral cru": 71.6,
            "Arroz integral cozido": 33.3,
            "Arroz agulha cru": 78.1,
            "Arroz 'solto' cozido": 28,
            "Arroz de cenoura/tomate": 20,
            "Arroz de ervilhas": 18,
            "Arroz de feij√£o": 20.8,
            "Arroz de tomate malandrinho": 16.8,
            "Massa crua": 71.1,
            "Massa cozida 'al dente'": 34.3,
            "Massa bem cozida": 19.9,
            "Bulgur/Couscous cru": 67.5,
            "Couscous cozido": 22.2,
            "Milho doce em conserva": 18.4,
            "Millet cru": 72.9,
            "Trigo Sarraceno gr√£o cru": 61.5,
            "Quinoa crua": 62
        },
        "Batata": {
            "Batata crua com pele": 16.7,
            "Batata crua": 19.2,
            "Batata cozida": 18.5,
            "Batata assada no forno": 24.8,
            "Pur√© de batata": 16.8,
            "Batata-doce crua com pele": 21.8,
            "Batata-doce crua ou assada": 28.3
        },
        "Leguminosas": {
            "Ervilhas congeladas cozidas": 7.5,
            "Ervilhas estufadas": 9.6,
            "Favas cozidas": 7.4,
            "Feij√£o branco cozido": 14.6,
            "Feij√£o frade cozido": 18.1,
            "Feij√£o manteiga cozido": 14,
            "Gr√£o-de-bico cozido": 16.7,
            "Lentilhas secas cozidas": 16.7,
            "Soja gr√£o seco cru": 18.3,
            "Tremo√ßo cozido": 7.2
        },
        "P√£o": {
            "P√£o de trigo branco": 57.3,
            "P√£o de trigo integral": 39.9,
            "P√£o de trigo integral com sementes": 43.2,
            "P√£o de centeio": 56.4,
            "P√£o de centeio integral": 41.3,
            "P√£o de mistura": 53.8,
            "P√£o de milho": 37.2,
            "P√£o ralado": 71.6,
            "Gressino": 67,
            "Tosta de trigo": 69.7,
            "Tosta de trigo integral": 62.6
        },
        "Bolachas": {
            "Bolacha √°gua e sal redonda": 61,
            "Bolacha tipo Cream cracker": 61.6,
            "Bolacha integral": 65.5,
            "Bolacha tipo Maria": 72
        },
        "Farinhas": {
            "Amido de milho": 90.2,
            "Farinha de milho": 75.3,
            "Farinha de trigo tipo 55": 74.3,
            "Farinha de trigo integral": 65.2,
            "Farinha de alfarroba": 85.6,
            "Farinha de am√™ndoa": 4.9,
            "Farinha de aveia": 57,
            "Farinha de espelta": 69.8,
            "Farinha de mandioca": 84.6,
            "Flocos de aveia": 61.7,
            "Tapioca": 87.5
        },
        "Fruta Fresca": {
            "Abacate (ed√≠vel)": 2.3,
            "Alperce/Damasco (ed√≠vel)": 8.5,
            "Ameixa branca (ed√≠vel)": 7.8,
            "Ameixa encarnada (ed√≠vel)": 7.4,
            "Ameixa rainha cl√°udia (ed√≠vel)": 11.8,
            "Amora": 4.5,
            "Anan√°s (ed√≠vel)": 9.5,
            "Anona (ed√≠vel)": 16.8,
            "Banana (ed√≠vel)": 21.8,
            "Carambola (ed√≠vel)": 7.1,
            "Cereja (ed√≠vel)": 13.3,
            "Clementina (ed√≠vel)": 11.1,
            "Diospiro (ed√≠vel)": 14.8,
            "Figo (ed√≠vel)": 16.3,
            "Framboesa (ed√≠vel)": 5.1,
            "Kiwi (ed√≠vel)": 10.9,
            "Laranja (ed√≠vel)": 8.9,
            "Lichia fresca": 14.8,
            "Ma√ß√£ ingerida com casca": 13.4,
            "Ma√ß√£ ingerida sem casca": 12.7,
            "Ma√ß√£ cozida sem a√ß√∫car": 10.5,
            "Ma√ß√£ assada sem a√ß√∫car": 15.7,
            "Manga (ed√≠vel)": 11.7,
            "Marmelo (ed√≠vel)": 9.3,
            "Melancia (ed√≠vel)": 5.5,
            "Mel√£o (ed√≠vel)": 5.7,
            "Meloa (ed√≠vel)": 4.2,
            "Mirtilo": 6.4,
            "Morango": 5.3,
            "Nectarina (ed√≠vel)": 8.7,
            "N√™spera (ed√≠vel)": 10.2,
            "Papaia (ed√≠vel)": 9.1,
            "P√™ra (ed√≠vel)": 9.4,
            "P√™ra cozida sem a√ß√∫car": 7.8,
            "P√™ssego (ed√≠vel)": 8.1,
            "Rom√£ (ed√≠vel)": 12,
            "Tangerina (ed√≠vel)": 8.7,
            "Uva branca (ed√≠vel)": 17.3,
            "Uva tinta (ed√≠vel)": 18.6,
            "Salada de fruta sem calda": 9.2
        },
        "Frutos Secos": {
            "Ameixa seca (ed√≠vel)": 37.8,
            "Figo seco (ed√≠vel)": 58.3,
            "T√¢mara (ed√≠vel)": 67.3,
            "Uva passa": 67
        },
        "Frutos Amil√°ceos e Oleaginosos": {
            "Castanha cozida": 35.9,
            "Castanha assada": 45.5,
            "Am√™ndoa torrada sem pele": 7.1,
            "Amendoim natural": 10.1,
            "Amendoim torrado com sal": 9.5,
            "Avel√£": 6,
            "Caju torrado": 19.4,
            "Noz": 3.6,
            "Pinh√£o": 5,
            "Pist√°chio torrado sem sal": 12.6
        },
        "Lactic√≠nios e Bebidas Vegetais": {
            "Leite de vaca": 4.9,
            "Iogurte s√≥lido natural / 0% a√ß√∫car": 5,
            "Iogurte l√≠quido 0% a√ß√∫car": 4.4,
            "Queijo creme de barrar": 3.7,
            "Queijo fresco": 3.2,
            "Queijo 'quark' natural": 4,
            "Requeij√£o": 4.6,
            "Bebida de am√™ndoa": 5.3,
            "Bebida de arroz": 11.8,
            "Bebida de aveia": 8.2,
            "Bebida de soja natural e s/ a√ß√∫car": 0.4
        },
        "Sopas": {
            "De vegetais s/batata/feij√£o/massa": 1.2,
            "Pur√© de vegetais com batata": 5.5,
            "De agri√£o com batata": 4.2,
            "Caldo verde com batata": 5.3,
            "De ervilhas com batata": 6.4,
            "De peixe com massa": 5.8,
            "Canja de galinha com arroz": 5.8
        },
        "Pratos Mistos": {
            "A√ßorda": 13.1,
            "A√ßorda √† alentejana": 12.3,
            "A√ßorda de marisco": 5.4,
            "Arroz √† valenciana": 7.7,
            "Arroz de cabidela": 12.2,
            "Arroz de frango": 25.2,
            "Arroz de gambas": 8.8,
            "Arroz de lulas": 6.7,
            "Arroz de marisco/de pato": 8.3,
            "Arroz de peixe": 15.5,
            "Arroz de polvo": 10.9,
            "Bacalhau √† br√°s": 8.3,
            "Bacalhau √† gomes de s√°": 7.4,
            "Bacalhau com natas e queijo ralado": 7.6,
            "Douradinhos": 17.5,
            "Caldeirada de peixe": 4.4,
            "Empad√£o de carne com batata": 10.7,
            "Feijoada com carne de porco": 13.3,
            "Jardineira de carne com ervilhas": 5.6,
            "Lasanha √† bolonhesa": 9.2,
            "Panados": 8.5,
            "Pizza queijo, tomate, fiambre": 29.2,
            "Quiche lorraine c/leite": 23.5,
            "Quiche vegetais": 12.9,
            "Salada Russa": 5.6
        },
        "Sementes": {
            "De ab√≥bora": 13.9,
            "De c√¢nhamo": 2.4,
            "De chia": 7.7,
            "De girassol": 17,
            "De linha√ßa": 18.1,
            "De papoila": 13.7,
            "De s√©samo": 6.4
        }
    };

    let currentCategory = null;
    let currentFood = null;
    let mealItems = [];

    // Inicializar categorias
    function initCategories() {
        const categoryList = document.getElementById('categoryList');
        Object.keys(foodDatabase).forEach(category => {
            const btn = document.createElement('button');
            btn.className = 'w-full px-4 py-3 text-left hover:bg-indigo-50 transition border-b border-gray-100';
            btn.textContent = category;
            btn.onclick = () => selectCategory(category);
            categoryList.appendChild(btn);
        });
    }

    // Selecionar categoria
    function selectCategory(category) {
        currentCategory = category;
        currentFood = null;
        document.getElementById('selectedCategory').textContent = category;
        document.getElementById('selectedCategory').className = 'text-gray-800';
        document.getElementById('categoryDropdown').classList.remove('active');
        
        // Mostrar se√ß√£o de alimentos
        document.getElementById('foodSection').classList.remove('hidden');
        document.getElementById('weightSection').classList.add('hidden');
        document.getElementById('addButton').classList.add('hidden');
        document.getElementById('selectedFood').textContent = 'Selecione um alimento';
        document.getElementById('selectedFood').className = 'text-gray-500';
        document.getElementById('weightInput').value = '';
        
        // Preencher lista de alimentos
        const foodList = document.getElementById('foodList');
        foodList.innerHTML = '';
        const foods = Object.keys(foodDatabase[category]).sort();
        foods.forEach(food => {
            const btn = document.createElement('button');
            btn.className = 'w-full px-4 py-3 text-left hover:bg-indigo-50 transition border-b border-gray-100';
            btn.innerHTML = `
                <div class="flex justify-between items-center">
                    <span>${food}</span>
                    <span class="text-sm text-gray-500">${foodDatabase[category][food]}g HC/100g</span>
                </div>
            `;
            btn.onclick = () => selectFood(food);
            foodList.appendChild(btn);
        });
    }

    // Selecionar alimento
    function selectFood(food) {
        currentFood = food;
        document.getElementById('selectedFood').textContent = food;
        document.getElementById('selectedFood').className = 'text-gray-800';
        document.getElementById('foodDropdown').classList.remove('active');
        document.getElementById('weightSection').classList.remove('hidden');
        document.getElementById('weightInput').focus();
    }

    // Toggle dropdown
    function toggleDropdown(type) {
        const dropdown = document.getElementById(type + 'Dropdown');
        dropdown.classList.toggle('active');
        
        // Fechar outro dropdown
        const other = type === 'category' ? 'food' : 'category';
        document.getElementById(other + 'Dropdown').classList.remove('active');
    }

    // Atualizar preview
    function updatePreview() {
        const weight = parseFloat(document.getElementById('weightInput').value);
        const preview = document.getElementById('carbPreview');
        const addBtn = document.getElementById('addButton');
        
        if (weight > 0 && currentFood && currentCategory) {
            const carbs = (weight * foodDatabase[currentCategory][currentFood]) / 100;
            preview.textContent = `= ${carbs.toFixed(1)}g de HC`;
            preview.classList.remove('hidden');
            addBtn.classList.remove('hidden');
        } else {
            preview.classList.add('hidden');
            addBtn.classList.add('hidden');
        }
    }

    // Adicionar alimento
    function addFood() {
        const weight = parseFloat(document.getElementById('weightInput').value);
        if (!currentFood || !weight || weight <= 0) return;

        const carbsPer100g = foodDatabase[currentCategory][currentFood];
        const carbs = (weight * carbsPer100g) / 100;

        mealItems.push({
            id: Date.now(),
            category: currentCategory,
            food: currentFood,
            weight: weight,
            carbsPer100g: carbsPer100g,
            carbs: carbs
        });

        renderMeal();
        
        // Reset
        document.getElementById('weightInput').value = '';
        document.getElementById('carbPreview').classList.add('hidden');
        document.getElementById('addButton').classList.add('hidden');
    }

    // Renderizar refei√ß√£o
    function renderMeal() {
        const container = document.getElementById('mealItems');
        container.innerHTML = '';

        mealItems.forEach(item => {
            const div = document.createElement('div');
            div.className = 'flex items-center justify-between p-4 bg-gray-50 rounded-xl border border-gray-200 item-enter';
            div.innerHTML = `
                <div class="flex-1">
                    <p class="font-medium text-gray-800">${item.food}</p>
                    <p class="text-sm text-gray-600">${item.weight}g ‚Ä¢ ${item.carbsPer100g}g HC/100g</p>
                </div>
                <div class="flex items-center gap-3">
                    <span class="text-lg font-bold text-indigo-600">${item.carbs.toFixed(1)}g</span>
                    <button onclick="removeItem(${item.id})" class="p-2 text-red-600 hover:bg-red-50 rounded-lg transition">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                    </button>
                </div>
            `;
            container.appendChild(div);
        });

        // Mostrar/esconder se√ß√µes
        const mealSection = document.getElementById('mealSection');
        const totalSection = document.getElementById('totalSection');
        
        if (mealItems.length > 0) {
            mealSection.classList.remove('hidden');
            totalSection.classList.remove('hidden');
            updateTotal();
        } else {
            mealSection.classList.add('hidden');
            totalSection.classList.add('hidden');
        }
    }

    // Atualizar total
    function updateTotal() {
        const total = mealItems.reduce((sum, item) => sum + item.carbs, 0);
        document.getElementById('totalCarbs').textContent = total.toFixed(1) + 'g';
    }

    // Remover item
    function removeItem(id) {
        mealItems = mealItems.filter(item => item.id !== id);
        renderMeal();
    }

    // Reset refei√ß√£o
    function resetMeal() {
        if (confirm('Tem a certeza que quer limpar todos os alimentos?')) {
            mealItems = [];
            renderMeal();
        }
    }

    // Inicializar app
    initCategories();

    // Fechar dropdowns ao clicar fora
    document.addEventListener('click', (e) => {
        if (!e.target.closest('.dropdown') && !e.target.closest('button')) {
            document.getElementById('categoryDropdown').classList.remove('active');
            document.getElementById('foodDropdown').classList.remove('active');
        }
    });

    // Service Worker para funcionar offline (PWA)
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('data:text/javascript,');
        });
    }
</script>
```

</body>
</html>
